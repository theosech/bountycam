(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[140],{1876:(e,t,s)=>{Promise.resolve().then(s.bind(s,2694))},2694:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var l=s(5155),n=s(2115),a=s(6046),r=s(7711),i=s(3259);let o=(0,r.default)(()=>Promise.all([s.e(484),s.e(761),s.e(13)]).then(s.bind(s,5013)),{loadableGenerated:{webpack:()=>[5013]},ssr:!1});function d(){let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)(null),[d,u]=(0,n.useState)(!0),[c,f]=(0,n.useState)(null),[m,p]=(0,n.useState)(null),h=(0,a.useRouter)(),b=(0,i.U)();(0,n.useEffect)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{let{latitude:t,longitude:s}=e.coords;r([t,s]),await x(t,s)},e=>{console.error("Error getting location:",e),r([34.0522,-118.2437]),x(34.0522,-118.2437)}):(r([34.0522,-118.2437]),x(34.0522,-118.2437))},[]);let x=async(e,s)=>{try{let{data:l,error:n}=await b.rpc("nearby_bounties",{user_lat:e,user_lng:s,radius_km:2});if(n)throw n;t(l||[])}catch(e){f(e.message)}finally{u(!1)}},g=async e=>{p(e),f(null);try{let{data:t,error:s}=await b.rpc("accept_bounty",{p_bounty_id:e});if(s)throw s;t.error?f(t.error):h.push("/session/".concat(t.session_id))}catch(e){f(e.message)}finally{p(null)}},y=e.map(e=>({id:e.id,position:[e.lat,e.lng],title:e.title,amount:e.amount}));return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Nearby Bounties"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Bounties Map"}),(0,l.jsx)("div",{className:"h-96",children:s&&(0,l.jsx)(o,{center:s,markers:y,zoom:13})})]}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Available Bounties"}),d&&(0,l.jsx)("p",{className:"text-gray-500",children:"Loading nearby bounties..."}),c&&(0,l.jsx)("div",{className:"text-red-600 text-sm mb-4",children:c}),(0,l.jsxs)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[e.map(e=>(0,l.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg",children:e.title}),(0,l.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[e.amount," pts"]})]}),e.description&&(0,l.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:[e.distance_km.toFixed(1)," km away"]}),(0,l.jsx)("button",{onClick:()=>g(e.id),disabled:m===e.id,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 text-sm",children:m===e.id?"Accepting...":"Accept Bounty"})]})]},e.id)),!d&&0===e.length&&(0,l.jsx)("p",{className:"text-gray-500",children:"No bounties found within 2km"})]})]})]})]})})}},3259:(e,t,s)=>{"use strict";s.d(t,{U:()=>n});var l=s(9956);function n(){return(0,l.createBrowserClient)("https://mrkagdenrvwgjbzatdfx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ya2FnZGVucnZ3Z2piemF0ZGZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg3MjE1ODAsImV4cCI6MjA2NDI5NzU4MH0.oY_lJ5jsq0FH91H2TZpTu09JURpGE4Yqsw3uzrgaZ_w")}},7711:(e,t,s)=>{"use strict";s.d(t,{default:()=>n.a});var l=s(1956),n=s.n(l)},1956:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let l=s(306)._(s(580));function n(e,t){var s;let n={};"function"==typeof e&&(n.loader=e);let a={...n,...t};return(0,l.default)({...a,modules:null==(s=a.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9827:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let l=s(3719);function n(e){let{reason:t,children:s}=e;if("undefined"==typeof window)throw new l.BailoutToCSRError(t);return s}},580:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let l=s(5155),n=s(2115),a=s(9827),r=s(9214);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},s=(0,n.lazy)(()=>t.loader().then(i)),d=t.loading;function u(e){let i=d?(0,l.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,u=o?n.Suspense:n.Fragment,c=t.ssr?(0,l.jsxs)(l.Fragment,{children:["undefined"==typeof window?(0,l.jsx)(r.PreloadChunks,{moduleIds:t.modules}):null,(0,l.jsx)(s,{...e})]}):(0,l.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(s,{...e})});return(0,l.jsx)(u,{...o?{fallback:i}:{},children:c})}return u.displayName="LoadableComponent",u}},9214:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return i}});let l=s(5155),n=s(7650),a=s(5861),r=s(8284);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let s=a.workAsyncStorage.getStore();if(void 0===s)return null;let i=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files;i.push(...t)}}return 0===i.length?null:(0,l.jsx)(l.Fragment,{children:i.map(e=>{let t=s.assetPrefix+"/_next/"+(0,r.encodeURIPath)(e);return e.endsWith(".css")?(0,l.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,n.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[191,441,517,358],()=>t(1876)),_N_E=e.O()}]);
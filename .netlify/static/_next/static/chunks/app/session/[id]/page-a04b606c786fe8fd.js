(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{218:(e,s,t)=>{Promise.resolve().then(t.bind(t,2703))},2703:(e,s,t)=>{"use strict";t.d(s,{default:()=>l});var a=t(5155),i=t(2115),r=t(6046),n=t(3259);function l(e){let{sessionId:s}=e,[t,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(!0),[o,x]=(0,i.useState)(null),[m,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)(null),b=(0,r.useRouter)(),g=(0,n.U)();(0,i.useEffect)(()=>{j()},[s]);let j=async()=>{try{let{data:{user:e}}=await g.auth.getUser();if(!e)throw Error("Not authenticated");p(e.id);let{data:t,error:a}=await g.from("sessions").select("\n          *,\n          bounty:bounties(*)\n        ").eq("id",s).single();if(a)throw a;l(t)}catch(e){x(e.message)}finally{d(!1)}},y=async e=>{u(!0),x(null);try{let{data:t,error:a}=await g.rpc("finish_session",{p_session_id:s,p_approved:e});if(a)throw a;t.error?x(t.error):b.push("/dashboard")}catch(e){x(e.message)}finally{u(!1)}};if(c)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Loading session..."})});if(!t)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-red-600",children:"Session not found"})});let N=h===t.streamer_id,v=h===t.bounty.creator_id;return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Streaming Session"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:t.bounty.title}),t.bounty.description&&(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:t.bounty.description})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Bounty Amount"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-indigo-600",children:[t.bounty.amount," points"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Session Status"}),(0,a.jsx)("p",{className:"text-xl font-bold capitalize",children:t.status})]})]}),(0,a.jsx)("div",{className:"bg-gray-900 rounded-lg aspect-video flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center text-white",children:[(0,a.jsx)("p",{className:"text-xl mb-2",children:"\uD83D\uDCF9 Live Stream Placeholder"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Video streaming will be implemented in Phase 2"})]})}),o&&(0,a.jsx)("div",{className:"text-red-600 text-sm",children:o}),v&&"active"===t.status&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"As the bounty creator, you can approve or reject this session:"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{onClick:()=>y(!0),disabled:m,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:m?"Processing...":"Approve & Pay"}),(0,a.jsx)("button",{onClick:()=>y(!1),disabled:m,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:m?"Processing...":"Reject"})]})]}),N&&"active"===t.status&&(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded",children:(0,a.jsx)("p",{className:"text-blue-900",children:"You are currently streaming for this bounty. The bounty creator will review and approve/reject when complete."})}),"completed"===t.status&&(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded",children:(0,a.jsx)("p",{className:"text-green-900",children:"This session has been completed."})})]})]})})})}},3259:(e,s,t)=>{"use strict";t.d(s,{U:()=>i});var a=t(9956);function i(){return(0,a.createBrowserClient)("https://mrkagdenrvwgjbzatdfx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ya2FnZGVucnZ3Z2piemF0ZGZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg3MjE1ODAsImV4cCI6MjA2NDI5NzU4MH0.oY_lJ5jsq0FH91H2TZpTu09JURpGE4Yqsw3uzrgaZ_w")}}},e=>{var s=s=>e(e.s=s);e.O(0,[191,441,517,358],()=>s(218)),_N_E=e.O()}]);